api.glovee.io {
    log {
        output stdout
        format json
    }

    # Test: Add headers based on request headers
    @has_refresh_token header X-Refresh-Token *
    
    handle @has_refresh_token {
        reverse_proxy postgrest:3000 {
            # Add response headers
            header_down X-Refresh-Token-Detected "yes"
            header_down X-Refresh-Token-Value {http.request.header.X-Refresh-Token}
        }
    }
    
    handle {
        reverse_proxy postgrest:3000
    }
}