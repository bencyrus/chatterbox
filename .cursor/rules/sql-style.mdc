---
description: SQL style guidelines
globs:
  - postgres/**/*.sql
alwaysApply: true
---

- Use lowercase SQL keywords and snake_case identifiers.
- Schemas are plural nouns (e.g., queues, comms, auth).
- DDL/data design: follow normalization; avoid deletes/updates; derive state from recorded facts.
- Use domains for small enumerations; keep names descriptive and consistent.
- Add a one-line comment above each table/type/function stating purpose.

- Prefer multi-line SQL for readability:
  - Put major clauses on separate lines: `select`, `from`, `join`, `where`, `group by`, `having`, `order by`, `limit`, `returning`.
  - Vertically list selected columns/expressions one per line under `select` (no trailing comma on the last item).
  - Single-item lists may remain inline with the directive: e.g., `select expr`, `order by expr`, `returning expr`.
  - In plpgsql, place `into` on its own line immediately after the `select` list.
  - For `insert`, place the column list on one line (or wrapped), `values` on a new line, and `returning` on a new line; put `into` on its own line when capturing.
  - Wrap subqueries and `exists(...)` predicates, with their inner `select ... from ... where ...` split across lines per these rules.
